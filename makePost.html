<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Make a post</title>

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

		<link rel="stylesheet" type="text/css" href="resources/styles.css">

		<!-- util.js contains functions that are used on multiple pages of the site -->
		<script type="text/javascript" src="resources/util.js"></script>
    </head>

    <body>

		<!-- header section -->
        <div class="container bg-color-orange-dark">
            <div class="row">
                <div class="col-sm">
					<img src="resources/images/icon.png" alt="Trust Network Logo">
                </div>
				<div class="col-sm">
					<h1 class="welcomText">say something...</h1>
                </div>
				<div class="col-sm">
					<button class="btn btn-primary" onclick="">Settings</button>
					<button class="btn btn-primary" onclick="">Logout</button>
                </div>
            </div>
        </div>

		<!-- mid section -->
		<div class="container bg-color-orange-medium">
			<div class="row">
				<div class="col-sm-12 col-lg-6">
					<div class="row">
						<canvas id="imageCanvas" src="noimage.jpg" width="320" height="240"></canvas>
					</div>
					<div class="row">
						<input id="fileToUpload" type="file" name="aFile">
					    <button class="btn btn-primary" onclick="uploadImage()">Upload</button>
					</div>


				</div>
				<div class="col-sm-12 col-lg-6">

					<!-- the onsubmit attribute allows the text to be processed before it is submitted to the database -->
					<form action="makePost.php" method="POST" onsubmit="encodeText()">
						<textarea class="makePostText" name="postText" id="postText" rows="5" cols="40"></textarea><br><br>
						<input class="btn btn-primary" type="submit" value="Submit" name="submit">
						 <input type="hidden" id="imagedata" name="imagedata" /> 
					</form>

				</div>
			</div>
		</div>
		
		<!-- footer section -->
		<div class="container bg-color-orange-light">
			<div class="row">
				<div class="col-sm">
					<p>kludge</p>
					<p>kludge</p>
					<p>kludge</p>
					
				</div>
			</div>
		</div>

		<script>

            var canvas = document.getElementById("imageCanvas");
            var canvasContext = canvas.getContext("2d");

			/*var base_image = new Image();
            base_image.src = "noimage.jpg";
            canvasContext.drawImage(base_image, 100, 100);*/

            function uploadImage()
            {
                var uploadedImage = document.createElement("IMG");

                var fileToOpen = document.getElementById("fileToUpload").value;
		
				fileToOpen = fileToOpen.replace("C:\\fakepath\\","");

				uploadedImage.setAttribute("src", fileToOpen);
                uploadedImage.setAttribute("width", "320");
                uploadedImage.setAttribute("height", "240");
                uploadedImage.setAttribute("alt", "Uploaded image");
                //document.body.appendChild(uploadedImage); //!

				canvasContext.drawImage(uploadedImage,0,0,320,240);

				var imageData = canvasContext.getImageData(0, 0, 320, 240);

				document.getElementById("imagedata").value = imageData.data;

				//document.getElementById("imagedata").value = "1,2,3";

				imageData.data = encodeImage(imageData.data);

				document.getElementById("imagedata").value = imageData.data;

            }

			function post()
			{
				
			}

			/* this function iterates over the text in the text field and eciphers
			it according to the users key or "shift" */
			function encodeText()
			{
				var textToEncrypt = document.getElementById("postText").value;
				var newString = "";
			
				var shift = parseInt(getCookie("key"));
				
				for(var i = 0; i < textToEncrypt.length; i++)
				{
					newString += String.fromCharCode(textToEncrypt.charCodeAt(i) + shift);
					
				}

				document.getElementById("postText").value = newString;

			}

			function encodeImage(arg)
			{
				var red = [29,143,229,252,124,204,197,206,71,36,166,50,105,165,13,117,232,83,84,80,28,240,249,177,27,22,88,7,156,21,75,115,202,244,175,119,251,168,8,181,201,66,9,3,191,145,125,157,44,23,192,135,172,216,173,72,235,139,227,159,176,102,33,212,109,214,99,211,224,129,110,189,70,187,149,79,31,238,30,128,20,82,91,203,61,6,155,46,207,108,127,56,241,111,60,215,164,18,77,42,246,133,162,112,138,142,247,89,16,134,78,169,54,97,183,185,188,96,126,52,186,64,81,2,170,98,40,210,51,47,73,148,154,45,190,121,218,10,106,116,150,243,146,255,101,85,253,195,34,213,19,140,92,219,163,37,131,250,151,231,113,182,223,158,178,225,43,239,167,200,234,100,230,57,12,226,11,233,208,93,248,53,55,237,14,141,104,160,58,153,179,180,32,95,171,1,49,114,136,193,59,152,94,209,132,130,63,90,199,161,87,245,147,196,198,35,228,103,4,74,86,24,123,220,122,48,39,107,174,205,184,65,26,25,5,118,236,242,69,68,17,62,217,222,221,137,15,76,41,38,67,254,194,144,120];

				var green = [32,118,197,240,66,204,251,239,165,177,163,58,148,232,221,205,203,4,189,117,173,55,170,135,216,96,150,131,185,16,195,46,164,49,236,166,116,8,91,104,56,139,35,13,196,130,193,28,201,244,129,122,223,101,149,235,174,191,121,106,250,23,29,9,37,3,147,103,128,209,179,225,230,198,111,85,214,86,92,81,154,219,226,124,228,90,248,125,6,229,186,222,97,160,119,143,252,5,100,65,27,105,82,233,243,120,227,202,126,142,48,107,99,36,64,31,93,137,38,109,62,19,190,51,168,68,215,178,255,67,98,242,80,78,210,169,59,47,7,153,113,213,73,69,20,180,45,237,14,76,141,40,145,200,241,26,71,175,41,234,184,151,182,2,44,156,176,194,140,158,87,188,112,53,24,162,110,115,33,63,134,61,11,84,108,254,0,102,77,75,161,70,74,89,25,155,247,34,127,146,133,187,144,95,159,245,231,157,253,54,52,211,42,132,60,88,218,12,39,72,10,15,217,192,172,17,123,207,183,114,79,94,199,181,238,220,167,249,212,50,43,22,30,136,18,1,206,138,152,208,21,224,57,171,246,83];

				var blue = [141,181,60,37,23,73,94,191,56,180,103,211,43,104,234,192,36,18,253,146,83,249,176,125,177,165,214,77,199,187,53,75,200,159,150,132,6,2,117,164,68,123,239,38,82,114,167,154,230,59,136,9,61,251,31,224,244,102,208,48,235,70,171,137,182,194,207,175,227,147,139,126,226,3,231,254,42,245,215,15,156,144,14,225,88,155,204,99,86,87,11,185,124,178,91,173,98,28,17,218,201,84,172,5,210,143,85,69,1,122,248,67,41,35,142,198,170,133,63,213,97,163,152,140,26,107,55,8,223,151,121,221,129,250,51,188,46,89,80,32,52,58,209,71,233,90,10,30,237,4,145,96,106,255,50,92,76,190,169,65,100,160,113,120,219,22,229,195,196,74,13,206,174,39,33,212,34,197,184,246,193,247,149,12,7,20,205,110,130,228,161,54,93,203,57,16,138,66,135,134,27,95,19,44,243,108,40,166,111,220,64,236,105,119,157,242,79,24,118,0,25,168,179,128,47,216,109,112,78,238,62,183,222,131,72,29,158,202,21,49,116,153,240,81,217,186,189,148,252,241,115,101,45,127,232,162];

				for(var i = 0; i < arg.length; i += 4)
				{
					arg[i] = red[arg[i] - 1];
					arg[i + 1] = green[arg[i+1] - 1];
					arg[i + 2] = blue[arg[i+2] - 1];
				}
			
				return arg;
			
			}

        </script>
    </body>
</html>